ipvar PGSQL_SERVERS [172.20.1.238,172.20.1.10]
portvar PGSQL_PORTS [5432]

alert tcp $EXTERNAL_NET any -> $PGSQL_SERVERS $PGSQL_PORTS (msg:"SERVER-POSTGRES dml"; flow:to_server,established; pcre:"/(SELECT|INSERT|UPDATE|DELETE)/i"; classtype:not-suspicious; sid:1500001; rev:1;)
alert tcp $EXTERNAL_NET any -> $PGSQL_SERVERS $PGSQL_PORTS (msg:"SERVER-POSTGRES alter user with superuser"; flow:to_server,established; content:"ALTER USER"; nocase; content:"WITH SUPERUSER"; nocase; within:32; classtype:attempted-admin; sid:1500002; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "METASPLOIT-PAYLOAD php/bind_perl runnable (exact)"; flow:to_server,established; content:"|70 65 72 6c 20 2d 4d 49 4f 20 2d 65 20 27 24 70 3d 66 6f 72 6b 28 29 3b 65 78 69 74 2c 69 66 24 70 3b 24 63 3d 6e 65 77 20 49 4f 3a 3a 53 6f 63 6b 65 74 3a 3a 49 4e 45 54 28 4c 6f 63 61 6c 50 6f 72 74 2c|"; content:"|2c 52 65 75 73 65 2c 31 2c 4c 69 73 74 65 6e 29 2d 3e 61 63 63 65 70 74 3b 24 7e 2d 3e 66 64 6f 70 65 6e 28 24 63 2c 77 29 3b 53 54 44 49 4e 2d 3e 66 64 6f 70 65 6e 28 24 63 2c 72 29 3b 73 79 73 74 65 6d 24 5f 20 77 68 69 6c 65 3c 3e 27|"; distance:1;  within:84; classtype:shellcode-detect; sid:1500100; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "METASPLOIT-PAYLOAD php/bind_perl base64 fragment"; flow:to_server,established; content:"cGVybCAtTUlPIC1lICckcD1mb3JrKCk7ZXhpdCxpZiRwOyRjPW5ldyBJTzo6U29ja2V0OjpJTkVUK"; classtype:shellcode-detect; sid:1500101; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "METASPLOIT-PAYLOAD ruby/shell_bind_tcp runnable (exact)"; flow:to_server,established; content:"|72 65 71 75 69 72 65 20 27 73 6f 63 6b 65 74 27 3b 73 3d 54 43 50 53 65 72 76 65 72 2e 6e 65 77 28|"; content:"|29 3b 63 3d 73 2e 61 63 63 65 70 74 3b 73 2e 63 6c 6f 73 65 3b 24 73 74 64 69 6e 2e 72 65 6f 70 65 6e 28 63 29 3b 24 73 74 64 6f 75 74 2e 72 65 6f 70 65 6e 28 63 29 3b 24 73 74 64 65 72 72 2e 72 65 6f 70 65 6e 28 63 29 3b 24 73 74 64 69 6e 2e 65 61 63 68 5f 6c 69 6e 65 7b 7c 6c 7c 6c 3d 6c 2e 73 74 72 69 70 3b 6e 65 78 74 20 69 66 20 6c 2e 6c 65 6e 67 74 68 3d 3d 30 3b 28 49 4f 2e 70 6f 70 65 6e 28 6c 2c 22 72 62 22 29 7b 7c 66 64 7c 20 66 64 2e 65 61 63 68 5f 6c 69 6e 65 20 7b 7c 6f 7c 20 63 2e 70 75 74 73 28 6f 2e 73 74 72 69 70 29 20 7d 7d 29 20 72 65 73 63 75 65 20 6e 69 6c 20 7d|"; distance:1;  within:202; classtype:shellcode-detect; sid:1500102; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "METASPLOIT-PAYLOAD ruby/shell_bind_tcp base64 fragment"; flow:to_server,established; content:"cmVxdWlyZSAnc29ja2V0JztzPVRDUFNlcnZlci5uZXcoN"; classtype:shellcode-detect; sid:1500103; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD ruby/shell_reverse_tcp_ssl base64 fragment"; content:"cmVxdWlyZSAnc29ja2V0JztyZXF1aXJlICdvcGVuc3NsJztjPU9wZW5TU0w6OlNT"; sid:1600068; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD ruby/shell_reverse_tcp base64 fragment"; content:"cmVxdWlyZSAnc29ja2V0JztjPVRDUFNvY2tldC5uZXcoIiIsIDQ0NDQpOyRzdGRp"; sid:1600069; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD ruby/shell_bind_tcp base64 fragment"; content:"cmVxdWlyZSAnc29ja2V0JztzPVRDUFNlcnZlci5uZXcoNDQ0NCk7Yz1zLmFjY2Vw"; sid:1600070; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/shell_reverse_tcp_ssl base64 fragment"; content:"aW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zLHNzbApzbz1zb2NrZXQuc29ja2V0"; sid:1600071; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/shell_reverse_tcp base64 fragment"; content:"aW1wb3J0IHNvY2tldCxvcwpzbz1zb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVU"; sid:1600072; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter_reverse_tcp base64 fragment"; content:"IyEvdXNyL2Jpbi9weXRob24KIyB2aW06IHRhYnN0b3A9NCBzb2Z0dGFic3RvcD00"; sid:1600073; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter_reverse_https base64 fragment"; content:"IyEvdXNyL2Jpbi9weXRob24KIyB2aW06IHRhYnN0b3A9NCBzb2Z0dGFic3RvcD00"; sid:1600074; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter_reverse_http base64 fragment"; content:"IyEvdXNyL2Jpbi9weXRob24KIyB2aW06IHRhYnN0b3A9NCBzb2Z0dGFic3RvcD00"; sid:1600075; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter_bind_tcp base64 fragment"; content:"IyEvdXNyL2Jpbi9weXRob24KIyB2aW06IHRhYnN0b3A9NCBzb2Z0dGFic3RvcD00"; sid:1600076; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD php/exec base64 fragment"; content:"ZWNobyAidG9vcjo6MDowOjo6L2Jpbi9iYXNoIj4vZXRjL3Bhc3N3ZA=="; sid:1600077; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD php/bind_perl base64 fragment"; content:"cGVybCAtTUlPIC1lICckcD1mb3JrKCk7ZXhpdCxpZiRwOyRjPW5ldyBJTzo6U29j"; sid:1600078; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD cmd/unix/reverse_python_ssl base64 fragment"; content:"aW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zLHNzbApzbz1zb2NrZXQuc29ja2V0"; sid:1600079; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD cmd/unix/reverse_python base64 fragment"; content:"aW1wb3J0IHNvY2tldCAgICwgIHN1YnByb2Nlc3MgICAsICBvcyAgICAgIDsgICBo"; sid:1600080; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD cmd/unix/bind_inetd base64 fragment"; content:"AdVARCNZzdQACIeoSlbAqNaVPKFjQRet"; sid:1600081; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter/reverse_tcp_uuid base64 fragment"; content:"aW1wb3J0IHNvY2tldCxzdHJ1Y3QKcz1zb2NrZXQuc29ja2V0KDIsc29ja2V0LlNP"; sid:1600082; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter/reverse_tcp_ssl base64 fragment"; content:"aW1wb3J0IHNzbCxzb2NrZXQsc3RydWN0CnNvPXNvY2tldC5zb2NrZXQoMiwxKQpz"; sid:1600083; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter/reverse_tcp base64 fragment"; content:"aW1wb3J0IHNvY2tldCxzdHJ1Y3QKcz1zb2NrZXQuc29ja2V0KDIsc29ja2V0LlNP"; sid:1600084; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter/reverse_https base64 fragment"; content:"aW1wb3J0IHN5cwp2aT1zeXMudmVyc2lvbl9pbmZvCnVsPV9faW1wb3J0X18oezI6"; sid:1600085; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter/reverse_http base64 fragment"; content:"aW1wb3J0IHN5cwp2aT1zeXMudmVyc2lvbl9pbmZvCnVsPV9faW1wb3J0X18oezI6"; sid:1600086; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter/bind_tcp_uuid base64 fragment"; content:"aW1wb3J0IHNvY2tldCxzdHJ1Y3QKYj1zb2NrZXQuc29ja2V0KDIsc29ja2V0LlNP"; sid:1600087; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD python/meterpreter/bind_tcp base64 fragment"; content:"aW1wb3J0IHNvY2tldCxzdHJ1Y3QKYj1zb2NrZXQuc29ja2V0KDIsc29ja2V0LlNP"; sid:1600088; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"METASPLOIT-PAYLOAD java/meterpreter/reverse_https base64 fragment"; content:"5V_SPwoLTscWIRIwTqqHcQZm9I8vmOI6BGE-z3bavyWFQ7WfJ0qj58NiiI-dNTSd"; sid:1600089; rev:1;)
