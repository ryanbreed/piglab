# Copyright 2001-2017 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#--------------------
# POLICY-OTHER RULES
#--------------------

# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Shockwave Flash file using doswf packer"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"ByteArray"; content:"doswf"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; classtype:policy-violation; sid:37929; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Shockwave Flash suspicious flash file using URLDownloadToFileA"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"ByteArray"; content:"URLDownloadToFileA"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; classtype:policy-violation; sid:37928; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Shockwave Flash file using doswf packer"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"ByteArray"; content:"doswf"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0569; reference:url,www.adobe.com/support/security/bulletins/apsb14-22.html; classtype:policy-violation; sid:37923; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Shockwave Flash suspicious flash file using URLDownloadToFileA"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"ByteArray"; content:"URLDownloadToFileA"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:37922; rev:2;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"POLICY-OTHER Microsoft Windows SMB potential group policy fallback exploit attempt"; flow:to_server,established; content:"|FF|SMB"; depth:4; offset:4; content:"|5C 00|g|00|p|00|t|00|T|00|m|00|p|00|l|00|.|00|i|00|n|00|f|00 00|"; fast_pattern:only; detection_filter:track by_src,count 5,seconds 2; metadata:service netbios-ssn; reference:cve,2015-0009; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-014; classtype:policy-violation; sid:33429; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"POLICY-OTHER Microsoft Windows Terminal server RDP attempt"; flow:to_server,established; content:"|03 00 00 0B 06 E0 00 00 00 00 00|"; depth:11; metadata:ruleset community; reference:bugtraq,3099; reference:cve,2001-0540; reference:cve,2001-0663; reference:nessus,10940; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-052; classtype:protocol-command-decode; sid:1447; rev:19;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"POLICY-OTHER Microsoft Windows Terminal server request attempt"; flow:to_server,established; content:"|03 00 00|"; depth:3; content:"|E0 00 00 00 00 00|"; depth:6; offset:5; metadata:ruleset community; reference:bugtraq,3099; reference:cve,2001-0540; reference:cve,2001-0663; reference:nessus,10940; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-052; classtype:protocol-command-decode; sid:1448; rev:19;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"POLICY-OTHER Microsoft Windows Terminal Server no encryption session initiation attempt"; flow:to_server,established; content:"|03 00 01|"; depth:3; content:"|00|"; depth:1; offset:288; metadata:ruleset community; reference:cve,2001-0663; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-052; classtype:attempted-dos; sid:2418; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Seagate BlackArmor administrator password reset attempt"; flow:to_server,established; content:"/d41d8cd98f00b204e9800998ecf8427e.php"; fast_pattern:only; http_uri; metadata:policy security-ips drop, service http; reference:cve,2012-2568; reference:url,osvdb.org/show/osvdb/82449; reference:url,www.kb.cert.org/vuls/id/515283; classtype:attempted-admin; sid:23102; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"POLICY-OTHER script tag in URI - likely cross-site scripting attempt"; flow:to_server,established; content:"<SCRIPT"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2014-4075; reference:cve,2014-4116; reference:cve,2015-1653; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-073; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-036; classtype:web-application-attack; sid:7070; rev:21;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"POLICY-OTHER AFS access"; flow:to_server; content:"|00 00 03 E7 00 00 00 00 00 00 00|e|00 00 00 00 00 00 00 00 0D 05 00 00 00 00 00 00 00|"; fast_pattern:only; metadata:ruleset community; reference:nessus,10441; classtype:misc-activity; sid:1504; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY-OTHER FTP anonymous login attempt"; flow:to_server,established; content:"USER"; fast_pattern:only; pcre:"/^USER\s+(anonymous|ftp)[^\w]*[\r\n]/smi"; metadata:ruleset community, service ftp; classtype:misc-activity; sid:553; rev:13;)
# alert tcp $HOME_NET 23 -> $EXTERNAL_NET any (msg:"POLICY-OTHER WinGate telnet server response"; flow:to_client,established; content:"WinGate>"; metadata:ruleset community; reference:cve,1999-0657; classtype:misc-activity; sid:555; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 9100 (msg:"POLICY-OTHER HP JetDirect LCD modification attempt"; flow:to_server,established; content:"@PJL RDYMSG DISPLAY ="; metadata:ruleset community; reference:bugtraq,2245; classtype:misc-activity; sid:568; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 9000:9002 (msg:"POLICY-OTHER HP JetDirect LCD modification attempt"; flow:to_server,established; content:"@PJL RDYMSG DISPLAY ="; metadata:ruleset community; reference:bugtraq,2245; classtype:misc-activity; sid:510; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1723 (msg:"POLICY-OTHER PPTP Start Control Request attempt"; flow:to_server,established,no_stream; content:"|00 01|"; depth:2; offset:2; content:"|00 01|"; depth:2; offset:8; metadata:ruleset community; classtype:attempted-admin; sid:2044; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 49 (msg:"POLICY-OTHER xtacacs login attempt"; flow:to_server; content:"|80 01|"; depth:2; content:"|00|"; distance:4; metadata:ruleset community; classtype:misc-activity; sid:2040; rev:7;)
# alert udp $HOME_NET 49 -> $EXTERNAL_NET any (msg:"POLICY-OTHER xtacacs accepted login response"; flow:to_client; content:"|80 02|"; depth:2; content:"|01|"; distance:4; metadata:ruleset community; classtype:misc-activity; sid:2042; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"POLICY-OTHER IPSec PGPNet connection attempt"; flow:to_server; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 10 02 00 00 00 00 00 00 00 00 88 0D 00 00 5C 00 00 00 01 00 00 00 01 00 00 00|P|01 01 00 02 03 00 00 24 01 01 00 00 80 01 00 06 80 02 00 02 80 03 00 03 80 04 00 05 80 0B 00 01 00 0C 00 04 00 01|Q|80 00 00 00 24 02 01 00 00 80 01 00 05 80 02 00 01 80 03 00 03 80 04 00 02 80 0B 00 01 00 0C 00 04 00 01|Q|80 00 00 00 10|"; fast_pattern:only; metadata:ruleset community; classtype:protocol-command-decode; sid:1771; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 9030:9031 (msg:"POLICY-OTHER TOR traffic anonymizer server request"; flow:established,to_server; content:"GET /tor/server"; fast_pattern:only; classtype:policy-violation; sid:9324; rev:5;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 3544 (msg:"POLICY-OTHER Outbound Teredo traffic detected"; flow:to_server; content:" |01|"; depth:2; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-038; classtype:policy-violation; sid:12065; rev:5;)
# alert udp $EXTERNAL_NET 3544 -> $HOME_NET any (msg:"POLICY-OTHER Inbound Teredo traffic detected"; flow:to_server; content:"?|FE 83 1F|"; depth:4; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-038; classtype:policy-violation; sid:12068; rev:5;)
# alert udp $EXTERNAL_NET 3544 -> $HOME_NET any (msg:"POLICY-OTHER Inbound Teredo traffic detected"; flow:to_server; content:" |01|"; depth:2; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-038; classtype:policy-violation; sid:12066; rev:6;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 3544 (msg:"POLICY-OTHER Outbound Teredo traffic detected"; flow:to_server; content:"?|FE 83 1F|"; depth:4; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-038; classtype:policy-violation; sid:12067; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"POLICY-OTHER TOR proxy connection initiation - second alternate port"; flow:to_server,established; content:"TOR"; content:"client <identity>"; classtype:policy-violation; sid:13698; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"POLICY-OTHER TOR proxy connection initiation - alternate port"; flow:to_server,established; content:"TOR"; content:"client <identity>"; classtype:policy-violation; sid:13697; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER Microsoft Windows Dr. Watson error reporting attempt"; flow:to_server,established; content:"User-Agent|3A| MSDW|0D 0A|"; fast_pattern:only; http_header; content:"watson.microsoft.com"; http_header; content:"StageOne"; http_uri; metadata:service http; reference:url,oca.microsoft.com/en/dcp20.asp; classtype:policy-violation; sid:13864; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER proxycgi proxy connection detected"; flow:established,to_server; content:"/cgi-bin/anon-www.cgi/http"; fast_pattern:only; http_uri; metadata:service http; reference:url,anonymouse.org; classtype:policy-violation; sid:19475; rev:4;)
# alert udp $HOME_NET any -> any 53 (msg:"POLICY-OTHER hamachi VPN outbound traffic detected"; flow:to_server; content:"|01 00|"; depth:2; offset:2; content:"|0A|hamachi-dc|0F|logmein-gateway|03|com"; fast_pattern:only; reference:url,secure.logmein.com/products/hamachi2/download.aspx; classtype:policy-violation; sid:19474; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER stunnel proxy connection detected"; flow:established,to_client; content:"|13 16|Stunnel Developers Ltd"; fast_pattern:only; reference:url,en.wikipedia.org/wiki/Stunnel; classtype:policy-violation; sid:19473; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER proxytunnel proxy connection detected"; flow:established,to_server; content:"CONNECT localhost|3A|22"; depth:20; nocase; metadata:service http; reference:url,proxytunnel.sourceforge.net; classtype:policy-violation; sid:19472; rev:4;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"POLICY-OTHER dnstunnel v0.5 outbound traffic detected"; flow:to_server; content:"|01 00|"; depth:2; offset:2; byte_test:1,>,20,12; content:!"sophosxl|03|net"; content:!"senderbase|03|org"; content:!"proofpoint|03|com"; content:"|00 10 00 01|"; offset:34; detection_filter:track by_src, count 10, seconds 1; metadata:service dns; reference:url,www.hsc.fr/ressources/outils/dns2tcp/index.html.en; classtype:policy-violation; sid:19471; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER Rapidshare file-sharing site contacted"; flow:established,to_server; content:"auth.html?"; nocase; http_uri; content:"authcode="; distance:0; nocase; http_uri; content:"Host|3A| www.rapidshare.com"; fast_pattern:only; http_header; metadata:service http; reference:url,www.rapidshare.com; classtype:policy-violation; sid:19737; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER Filesonic file-sharing site contacted"; flow:established,to_server; content:"Host|3A|"; nocase; http_header; content:"www.filesonic.com"; within:50; fast_pattern; nocase; http_header; metadata:service http; reference:url,www.filesonic.com; classtype:policy-violation; sid:19735; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER Megaupload file-sharing site contacted"; flow:established,to_server; content:"/upload_done.php"; nocase; http_uri; content:".megaupload.com"; fast_pattern:only; http_header; pcre:"/^Host\x3A[^\r\n]+\.megaupload\.com/Hsmi"; metadata:service http; reference:url,www.megaupload.com; classtype:policy-violation; sid:19736; rev:5;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER logmein.com connection attempt"; flow:to_client,established; content:"secure|2E|logmein|2E|com"; fast_pattern:only; reference:url,secure.logmein.com; classtype:policy-violation; sid:19780; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER Glype proxy usage detected"; flow:established,to_server; content:"/browse.php?"; nocase; http_uri; content:"u=Oi8v"; distance:0; nocase; http_uri; content:"b="; distance:0; nocase; http_uri; metadata:service http; reference:url,www.glype.com; classtype:policy-violation; sid:20136; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER Privoxy disabling of x-filter"; flow:to_server,established; content:"x|2D|filter|3A|"; nocase; http_header; content:"No"; within:10; nocase; http_header; metadata:service http; reference:cve,2007-6724; reference:url,pseudo-flaw.net/content/tor/vidalia-insecure-privoxy-configuration/; classtype:policy-violation; sid:20243; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY-OTHER possible forced privoxy disabling"; flow:to_client,established; content:"Location|3A|"; nocase; http_header; content:"http|3A 2F 2F|www|2E|privoxy|2E|org|2F|config|2F 3F|set|3D|disable"; within:100; nocase; http_header; metadata:service http; reference:cve,2007-6724; reference:url,pseudo-flaw.net/content/tor/vidalia-insecure-privoxy-configuration/; classtype:policy-violation; sid:20244; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY-OTHER remote privoxy config access"; flow:to_client,established; content:"Location|3A|"; nocase; http_header; content:"http|3A 2F 2F|www|2E|privoxy|2E|org|2F|config|2F|"; within:100; nocase; http_header; metadata:service http; reference:cve,2007-6724; reference:url,pseudo-flaw.net/content/tor/vidalia-insecure-privoxy-configuration/; classtype:policy-violation; sid:20245; rev:6;)
# alert tcp any any -> $HOME_NET 9100 (msg:"POLICY-OTHER HP Printer firmware update attempt"; flow:to_server,established; content:"@PJL COMMENT MODEL=HP"; fast_pattern:only; content:"|1B|%-12345X@PJL"; depth:13; nocase; content:"@PJL UPGRADE SIZE="; nocase; classtype:policy-violation; sid:20658; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 10651 (msg:"POLICY-OTHER Progrea Movicon TCPUploadServer.exe unauthenticated access attempt"; flow:established,to_server; content:"MovX"; depth:4; nocase; pcre:"/^[\x31-\x37\x42]/R"; reference:bugtraq,46907; reference:cve,2011-2963; classtype:attempted-admin; sid:20758; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 4848 (msg:"POLICY-OTHER TRACE attempt"; flow:to_server,established; content:"TRACE"; depth:5; reference:bugtraq,47818; reference:cve,2011-1511; classtype:web-application-attack; sid:20873; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER HP SiteScope integrationViewer default credentials policy-bypass attempt"; flow:to_server,established; content:"/SiteScope/j_security_check"; fast_pattern:only; http_uri; pcre:"/(j_username\x3D\x26)?[^\n]*j_password\x3D(\x26|$)([^\n]*j_username\x26(\x26|$))?/"; metadata:service http; reference:url,osvdb.org/show/osvdb/74865; classtype:policy-violation; sid:20996; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER HP SiteScope integrationViewer default credentials policy-bypass attempt"; flow:to_server,established; content:"/SiteScope/j_security_check"; http_uri; content:"j_username|3D|integrationViewer"; fast_pattern:only; pcre:"/j_password\x3DvKm46(\x2A|\x25\x32\x41)sdH(\x24|\x25\x32\x34)8109(\x23|\x25\x32\x33)JLSudh(\x3A|\x25\x33\x41)(\x29|\x25\x32\x39)/"; metadata:service http; reference:url,osvdb.org/show/osvdb/74865; classtype:policy-violation; sid:20995; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Telnet protocol specifier in web page attempt"; flow:to_client,established; file_data; content:"telnet|3A 2F 2F|"; fast_pattern:only; pcre:"/(src|href)\s*=\s*(\x22|\x27|)telnet\x3a\x2f\x2f/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,11731; reference:cve,2004-1541; classtype:policy-violation; sid:19669; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER TRENDnet IP Camera anonymous access attempt"; flow:to_server,established; content:"/anony/"; fast_pattern:only; http_uri; pcre:"/\/anony\/(jpgview\.htm|mjpeg\.cgi|view2\.cgi|mjpg\.cgi)/Ui"; metadata:ruleset community, service http; reference:url,console-cowboys.blogspot.com/2012/01/trendnet-cameras-i-always-feel-like.html; reference:url,www.trendnet.com/press/view.asp?id=1958; reference:url,www.wired.com/threatlevel/2012/02/home-cameras-exposed/; classtype:policy-violation; sid:21267; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER Microsoft Windows 98 User-Agent string"; flow:to_server,established; content:"User-Agent|3A| "; nocase; http_header; content:"Windows 98"; fast_pattern:only; http_header; pcre:"/^User-Agent\x3A[^\r\n]+Windows 98/Hsmi"; metadata:service http; reference:url,msdn.microsoft.com/en-us/library/ms537503(v=vs.85).aspx; classtype:policy-violation; sid:21556; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [8080,8090] (msg:"POLICY-OTHER Cisco Network Registrar default credentials authentication attempt"; flow:to_server,established; content:"GET"; nocase; http_method; content:"|2F|login|2E|js"; nocase; http_uri; content:"name=admin"; nocase; http_uri; content:"pass"; nocase; http_uri; content:"changeme"; within:12; http_uri; metadata:service http; reference:cve,2011-2024; reference:url,osvdb.org/show/osvdb/72720; reference:url,www.securityfocus.com/bid/48076; classtype:default-login-attempt; sid:20691; rev:5;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"POLICY-OTHER use of psexec remote administration tool"; flow:to_server,established; content:"|FF|SMB|A2|"; depth:5; offset:4; content:"|5C 00|p|00|s|00|e|00|x|00|e|00|c|00|s|00|v|00|c"; nocase; metadata:service netbios-ssn; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:24008; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY-OTHER TCP packet with urgent flag attempt"; flow:stateless; flags:U+; classtype:protocol-command-decode; sid:24378; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Adobe ColdFusion admin API access attempt"; flow:to_server,established; content:"/CFIDE/adminapi"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,57330; reference:cve,2013-0632; reference:url,www.adobe.com/support/security/advisories/apsa13-01.html; classtype:policy-violation; sid:25976; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Adobe ColdFusion component browser access attempt"; flow:to_server,established; content:"/CFIDE/componentutils"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,57330; reference:cve,2013-0632; reference:url,www.adobe.com/support/security/advisories/apsa13-01.html; classtype:policy-violation; sid:25977; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Adobe ColdFusion admin interface access attempt"; flow:to_server,established; content:"/CFIDE/administrator"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,57330; reference:cve,2013-0632; reference:url,www.adobe.com/support/security/advisories/apsa13-01.html; classtype:policy-violation; sid:25975; rev:2;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"POLICY-OTHER Achievement Unlocked -- Billion Dollar Company"; flow:to_server,established; content:"We've hit 1bn before but now we're solidly in there.  Woot"; fast_pattern:only; reference:url,www.nasdaq.com/article/sourcefire-inc-fire-surged-to-a-new-high-on-q4-results-20120223-00248; classtype:policy-violation; sid:20000; rev:6;)
# alert tcp $EXTERNAL_NET [$FILE_DATA_PORTS,443] -> $HOME_NET any (msg:"POLICY-OTHER Microsoft ADFS endpoint information disclosure attempt"; flow:to_client,established; file_data; content:"/adfs/services/trust/2005/windowstransport"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-3185; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-066; classtype:misc-activity; sid:27609; rev:3;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"POLICY-OTHER use of psexec remote administration tool SMBv2"; flow:to_server,established; content:"|FE|SMB"; depth:8; nocase; content:"|05 00|"; within:2; distance:8; content:"P|00|S|00|E|00|X|00|E|00|S|00|V|00|C|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:30281; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"POLICY-OTHER Chunked-Encoding transfer attempt"; flow:to_server,established; content:"Transfer-Encoding|3A|"; nocase; http_header; content:"chunked"; fast_pattern:only; http_header; metadata:ruleset community, service http; reference:bugtraq,4474; reference:bugtraq,4485; reference:bugtraq,5033; reference:cve,2002-0071; reference:cve,2002-0079; reference:cve,2002-0392; reference:nessus,10932; classtype:policy-violation; sid:1807; rev:21;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Rosetta Flash tool use attempt"; flow:to_server,established; content:"=ZWS"; fast_pattern:only; http_uri; urilen:>200; metadata:service http; reference:cve,2015-3096; reference:url,helpx.adobe.com/security/products/flash-player/apsb15-11.html; reference:url,miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/; reference:url,miki.it/blog/2014/8/15/adobe-really-fixed-rosetta-flash-today/; classtype:policy-violation; sid:31401; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Rosetta Flash tool use attempt"; flow:to_server,established; content:"=FWS"; fast_pattern:only; http_uri; urilen:>200; metadata:service http; reference:cve,2015-3096; reference:url,helpx.adobe.com/security/products/flash-player/apsb15-11.html; reference:url,miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/; reference:url,miki.it/blog/2014/8/15/adobe-really-fixed-rosetta-flash-today/; classtype:policy-violation; sid:31400; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Rosetta Flash tool use attempt"; flow:to_server,established; content:"=CWS"; fast_pattern:only; http_uri; urilen:>200; metadata:service http; reference:cve,2015-3096; reference:url,helpx.adobe.com/security/products/flash-player/apsb15-11.html; reference:url,miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/; reference:url,miki.it/blog/2014/8/15/adobe-really-fixed-rosetta-flash-today/; classtype:policy-violation; sid:31399; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER Adobe Flash Player possible cross-domain bypass attempt"; flow:to_server,established; content:"|0D 0A|X-"; fast_pattern:only; http_header; content:".swf"; http_header; pcre:"/^Host:\s*(?P<hostname>[^\s\x2f\x5c]+)[\s\x2f\x5c].*?Referer:\s*https?:\x2f\x2f(?!(?P=hostname))[^\n]*\x2eswf([\r\n\?]|$)/smiH"; metadata:service http; reference:bugtraq,68455; reference:cve,2014-0537; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:policy-violation; sid:31614; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER HP Universal CMDB default credentials authentication attempt"; flow:to_server,established; content:"/axis2/axis2-admin/login"; fast_pattern:only; http_uri; content:"username=admin"; nocase; content:"password=axis2"; nocase; metadata:service http; reference:bugtraq,68363; reference:cve,2014-2617; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c04357076; reference:url,osvdb.org/show/osvdb/108717; classtype:policy-violation; sid:31846; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $FTP_PORTS (msg:"POLICY-OTHER QLogic Switch 5600/5800 default ftp login attempt"; flow:to_server,established; content:"USER|20|images|0D 0A|"; flowbits:set,qlogic_default_ftp; flowbits:noalert; metadata:ruleset community, service ftp; reference:url,filedownloads.qlogic.com/files/Manual/81355/UserGuide_5800V_Series_QuickTools_v80_59264-02B.pdf; reference:url,filedownloads.qlogic.com/files/manual/67941/QuickTools_Guide_Sb5600_Series_v74_59235-03_%5BA%5D.pdf; classtype:default-login-attempt; sid:31831; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $FTP_PORTS (msg:"POLICY-OTHER QLogic Switch 5600/5800 default ftp login attempt"; flow:to_server,established; content:"PASS|20|images|0D 0A|"; flowbits:isset,qlogic_default_ftp; metadata:policy balanced-ips drop, policy security-ips drop, ruleset community, service ftp; reference:url,filedownloads.qlogic.com/files/Manual/81355/UserGuide_5800V_Series_QuickTools_v80_59264-02B.pdf; reference:url,filedownloads.qlogic.com/files/manual/67941/QuickTools_Guide_Sb5600_Series_v74_59235-03_%5BA%5D.pdf; classtype:default-login-attempt; sid:31830; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 6060 (msg:"POLICY-OTHER ManageEngine DeviceExpert user credentials enumeration attempt"; flow:to_server,established; content:"GET"; depth:3; content:"ReadUsersFromMasterServlet"; within:30; nocase; metadata:service http; reference:bugtraq,69443; reference:cve,2014-5377; reference:url,osvdb.org/show/osvdb/110522; classtype:policy-violation; sid:32092; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 9001 (msg:"POLICY-OTHER SolarWinds Log and Event Manager default credentials authentication attempt"; flow:to_server,established; content:"|00 00 00 06|trigeo|00 00 00 06|trigeo"; reference:bugtraq,69559; reference:cve,2014-5504; reference:url,osvdb.org/show/osvdb/110872; classtype:policy-violation; sid:32068; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Remote non-JavaScript file found in script tag src attribute"; flow:to_client,established; file_data; content:"<script"; content:"src="; within:30; isdataat:100,relative; content:!"|2E|js"; within:100; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6345; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065; classtype:policy-violation; sid:32481; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Visual Mining NetCharts default credentials authentication attempt"; flow:to_server,established; content:"U2NoZWR1bGVyOiFAIyRzY2hlZHVsZXIkI0Ah"; http_header; metadata:service http; reference:bugtraq,70895; reference:cve,2014-8516; reference:url,osvdb.org/show/osvdb/114127; classtype:policy-violation; sid:32526; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"POLICY-OTHER SSLv3 CBC client connection attempt"; flow:to_server,established; ssl_version:sslv3; ssl_state:client_hello; content:"|16 03 00|"; depth:3; content:"|00 00 02 00 2F|"; within:5; distance:40; metadata:service ssl; reference:cve,2014-3566; classtype:attempted-recon; sid:32566; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER ManageEngine Eventlog Analyzer information disclosure attempt"; flow:to_server,established; content:"/agentHandler"; nocase; http_uri; content:"mode=getTableData"; fast_pattern:only; http_uri; content:"table="; nocase; http_uri; metadata:service http; reference:cve,2014-6038; reference:url,osvdb.org/show/osvdb/114342; classtype:attempted-recon; sid:32603; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER ManageEngine Eventlog Analyzer credential disclosure attempt"; flow:to_server,established; content:"/hostdetails"; fast_pattern:only; http_uri; content:"slid="; nocase; http_uri; content:"hostid="; nocase; http_uri; metadata:service http; reference:cve,2014-6039; reference:url,osvdb.org/show/osvdb/114344; classtype:attempted-recon; sid:32602; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Arris VAP2500 default credentials authentication attempt"; flow:to_server,established; content:"e882245238cff6150a1a67b1cc336f4f"; fast_pattern:only; content:"e882245238cff6150a1a67b1cc336f4f"; nocase; http_cookie; metadata:service http; reference:bugtraq,71297; reference:cve,2014-8424; reference:url,osvdb.org/show/osvdb/115046; classtype:policy-violation; sid:32741; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Arris VAP2500 default credentials authentication attempt"; flow:to_server,established; content:"1b3231655cebb7a1f783eddf27d254ca"; fast_pattern:only; content:"1b3231655cebb7a1f783eddf27d254ca"; nocase; http_cookie; metadata:service http; reference:bugtraq,71297; reference:cve,2014-8424; reference:url,osvdb.org/show/osvdb/115046; classtype:policy-violation; sid:32740; rev:1;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [696,7426] (msg:"POLICY-OTHER HP Network Node Manager ovopi.dll command 685 insecure pointer dereference attempt"; flow:stateless; content:"|AD 02 00 00|"; depth:4; isdataat:2556,relative; reference:cve,2014-2624; reference:url,h20565.www2.hp.com/hpsc/doc/public/display?calledBy=&docId=emr_na-c04378450-2; reference:url,osvdb.org/show/osvdb/112522; classtype:policy-violation; sid:32729; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER base64 encoded executable file download"; flow:to_client,established; file_data; content:"TV"; depth:2; content:"A//8AALgAAAAAAAAAQAA"; within:200; metadata:service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/b9cf049a38d52f79e2a9c2d84b9bbc5ad39263a8b663cceda5cae12a3bdb65b8/analysis/; classtype:policy-violation; sid:32951; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER PirateBrowser User-Agent detected"; flow:to_server, established; content:"User-Agent: PB"; fast_pattern:only; http_header; pcre:"/User-Agent: PB\d\.\d/iH"; metadata:service http; reference:url,piratebrowser.com; classtype:policy-violation; sid:32907; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER ManageEngine Desktop Central DCPlugin insecure admin account creation attempt"; flow:to_server,established; content:"/DCPluginServelet"; fast_pattern:only; http_uri; content:"action=addPlugInUser"; nocase; http_uri; content:"role=DCAdmin"; nocase; http_uri; content:"password="; nocase; http_uri; metadata:service http; reference:bugtraq,71849; reference:cve,2014-7862; reference:url,osvdb.org/show/osvdb/116554; classtype:policy-violation; sid:32967; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 48080 (msg:"POLICY-OTHER SolarWinds Firewall Security Manager insecure userlogin.jsp access attempt"; flow:to_server,established; content:"GET /fsm/userlogin.jsp"; depth:22; nocase; metadata:service http; reference:cve,2015-2284; reference:url,osvdb.org/show/osvdb/119559; classtype:policy-violation; sid:33875; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Evercookie persistent cookie storage attempt"; flow:to_server,established; file_data; content:"this.evercookie_etag"; content:"function("; within:15; content:"name"; within:8; content:"value"; within:9; metadata:service smtp; reference:url,github.com/samyk/evercookie/blob/master/js/evercookie.js; classtype:policy-violation; sid:33964; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Evercookie persistent cookie storage attempt"; flow:to_client,established; file_data; content:"this.evercookie_etag"; content:"function("; within:15; content:"name"; within:8; content:"value"; within:9; metadata:service ftp-data, service http, service imap, service pop3; reference:url,github.com/samyk/evercookie/blob/master/js/evercookie.js; classtype:policy-violation; sid:33963; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER ManageEngine Desktop Central insecure admin password reset attempt"; flow:to_server,established; content:"/DCOperationsServlet"; fast_pattern:only; http_uri; content:"operation=addOrModifyUser"; nocase; http_uri; content:"roleId=DCAdmin"; nocase; http_uri; content:"password="; nocase; http_uri; metadata:service http; reference:cve,2015-2560; reference:url,osvdb.org/show/osvdb/120026; classtype:policy-violation; sid:33986; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER ManageEngine Desktop Central insecure admin password reset attempt"; flow:to_server,established; content:"/DCOperationsServlet"; fast_pattern:only; http_uri; content:"operation=addOrModifyUser"; nocase; http_client_body; content:"roleId=DCAdmin"; nocase; http_client_body; content:"password="; nocase; http_client_body; metadata:service http; reference:cve,2015-2560; reference:url,osvdb.org/show/osvdb/120026; classtype:policy-violation; sid:34024; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2224 (msg:"POLICY-OTHER Red Hat OpenStack default password login attempt"; flow:to_server,established; content:"hacluster"; fast_pattern:only; content:"CHANGEME"; metadata:service http; reference:cve,2015-1842; reference:url,rhn.redhat.com/errata/RHSA-2015-0791.html; classtype:attempted-admin; sid:34345; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 7080 (msg:"POLICY-OTHER Red Hat JBoss Operations Network web console access attempt"; flow:to_server,established; content:"/coregui/org.rhq.coregui.CoreGUI/"; fast_pattern:only; metadata:service http; reference:url,access.redhat.com/documentation/en-US/Red_Hat_JBoss_Operations_Network/3.3/html/Users_Guide/index.html; classtype:policy-violation; sid:34342; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 7080 (msg:"POLICY-OTHER Red Hat JBoss Operations Network ServerInvokerServlet access attempt"; flow:to_server,established; content:"GET /jboss-remoting-servlet-invoker/ServerInvokerServlet"; fast_pattern:only; metadata:service http; reference:cve,2015-0297; reference:url,rhn.redhat.com/errata/RHSA-2015-0862.html; classtype:policy-violation; sid:34341; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 7080 (msg:"POLICY-OTHER Red Hat JBoss Operations Network ServerInvokerServlet access attempt"; flow:to_server,established; content:"POST /jboss-remoting-servlet-invoker/ServerInvokerServlet"; fast_pattern:only; metadata:service http; reference:cve,2015-0297; reference:url,rhn.redhat.com/errata/RHSA-2015-0862.html; classtype:policy-violation; sid:34340; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $FTP_PORTS (msg:"POLICY-OTHER ProFTPD mod_copy unauthenticated file copy attempt"; flow:to_server,established; content:"SITE"; depth:4; nocase; content:"CPFR"; within:4; distance:1; fast_pattern; nocase; metadata:policy max-detect-ips drop, service ftp; reference:bugtraq,74238; reference:cve,2015-3306; reference:url,osvdb.org/show/osvdb/120834; classtype:policy-violation; sid:34447; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"POLICY-OTHER PHP tag injection in http header attempt"; flow:to_server,established; content:"<?php"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:cve,2013-1081; classtype:web-application-attack; sid:27027; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1098 (msg:"POLICY-OTHER RedHat JBOSS JNDI service naming"; flow:established,to_server; content:"javax.naming"; content:"org.jnp.interfaces.FastNamingProperties"; fast_pattern:only; metadata:policy max-detect-ips drop, service java_rmi; reference:bugtraq,54644; reference:cve,2011-4605; classtype:policy-violation; sid:25317; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12345 (msg:"POLICY-OTHER Adobe InDesign SOAP interface RunScript method access attempt"; flow:to_server,established; content:"|3C|IDSP|3A|RunScript|3E|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:url,osvdb.org/show/osvdb/87548; classtype:policy-violation; sid:24987; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"POLICY-OTHER PHP uri tag injection attempt"; flow:to_server,established; content:"<?php"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-0297; reference:cve,2012-2957; reference:url,osvdb.org/show/osvdb/82023; classtype:web-application-attack; sid:23111; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [8080,8090] (msg:"POLICY-OTHER Cisco network registrar default credentials authentication attempt"; flow:to_server,established; content:"/login.js"; nocase; http_uri; content:"name=admin"; nocase; http_uri; content:"pass"; nocase; http_uri; content:"changeme"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2011-2024; reference:url,osvdb.org/show/osvdb/72720; reference:url,www.securityfocus.com/bid/48076; classtype:default-login-attempt; sid:20692; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER HP Universal CMDB server axis2 service upload attempt"; flow:established,to_server; content:"POST"; nocase; http_method; content:"/axis2/axis2-admin/upload"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,secunia.com/advisories/42763/; classtype:attempted-admin; sid:19158; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER CA ARCserve Axis2 default credential login attempt"; flow:to_server,established; content:"/axis2-admin/login"; fast_pattern:only; http_uri; content:"userName=admin"; nocase; http_client_body; content:"password="; nocase; http_client_body; pcre:"/^(admin|axis2)/iR"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,45625; reference:cve,2010-0219; classtype:default-login-attempt; sid:18985; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 6504 (msg:"POLICY-OTHER CA BightStor ARCserver Backup possible insecure method access"; flow:established, to_server; dce_iface:506b1890-14c8-11d1-bbc3-00805fa6962e; dce_opnum:383-396; metadata:policy max-detect-ips drop, service dcerpc; reference:cve,2007-5328; reference:url,secunia.com/advisories/27192/; classtype:attempted-user; sid:17577; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY-OTHER file URI scheme attempt"; flow:established,to_client; file_data; content:"file|3A 2F 2F|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2011-3230; reference:url,tools.ietf.org/html/rfc1630; reference:url,tools.ietf.org/html/rfc1738; classtype:policy-violation; sid:16642; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 9001:9030 (msg:"POLICY-OTHER TOR proxy connection initiation"; flow:to_server,established; content:"TOR"; content:"client <identity>"; metadata:policy max-detect-ips drop; classtype:policy-violation; sid:13696; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 13782 (msg:"POLICY-OTHER VERITAS NetBackup system - execution function call access"; flow:established,to_server; content:"|00 18 00 1B 00 02|"; depth:18; metadata:policy max-detect-ips drop; reference:bugtraq,21565; reference:cve,2006-4902; reference:cve,2006-6822; classtype:misc-activity; sid:10130; rev:9;)
# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY-OTHER IPv6 packets encapsulated in IPv4"; ip_proto:41; metadata:policy max-detect-ips drop; reference:bugtraq,29235; reference:cve,2008-2136; classtype:policy-violation; sid:8446; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER web server file upload attempt"; flow:to_server,established; content:"Content-Disposition"; nocase; content:"filename"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:url,www.faqs.org/rfcs/rfc1867.html; classtype:misc-activity; sid:5708; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Novell ZENworks Configuration Management session id disclosure attempt"; flow:to_server,established; content:"/zenworks/rtr"; nocase; http_uri; content:"maintenance=ShowLogins"; fast_pattern:only; metadata:service http; reference:bugtraq,74289; reference:cve,2015-0784; reference:url,osvdb.org/show/osvdb/121157; classtype:policy-violation; sid:34584; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY-OTHER HP SiteScope unspecified privilege escalation attempt"; flow:to_server,established; content:"/SiteScope/remoteProxy?"; http_uri; content:"File name|74 00 0C|users.config"; fast_pattern:only; http_client_body; metadata:policy security-ips drop, service http; reference:cve,2015-2120; reference:url,h20564.www2.hp.com/hpsc/doc/public/display?docId=emr_na-c04688784 ; classtype:policy-violation; sid:34823; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Arcserve Unified Data Protection Management credential disclosure attempt"; flow:to_server,established; content:"/services/EdgeServiceImpl"; fast_pattern:only; http_uri; content:"getBackupPolicy"; nocase; http_client_body; metadata:service http; reference:bugtraq,74838; reference:cve,2015-4069; classtype:policy-violation; sid:34944; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 631 (msg:"POLICY-OTHER Apple Cups cupsd.conf change attempt"; flow:to_server,established; content:"PUT"; http_method; urilen:22; content:"/admin/conf/cupsd.conf"; fast_pattern:only; http_uri; metadata:service http; classtype:policy-violation; sid:35042; rev:1;)
# alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY-OTHER IPv6 neighbor solicitation - THC-IPv6 tool indicator attempt"; itype:135; icode:>0; detection_filter:track by_dst, count 4000, seconds 1; reference:url,thc.org/thc-ipv6/; classtype:misc-activity; sid:35098; rev:1;)
# alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY-OTHER IPv6 neighbor solicitation - THC-IPv6 tool indicator attempt"; itype:135; icode:>0; content:"XXXXXX"; fast_pattern:only; reference:url,thc.org/thc-ipv6/; classtype:misc-activity; sid:35097; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Microsoft Internet Explorer InPrivate mode image information leak attempt"; flow:to_server,established; file_data; content:".getElementById"; nocase; content:".width"; within:100; nocase; content:".height"; within:50; nocase; pcre:"/\x2EgetElementById\x28[\x22\x27]?(?P<element>\w+)[\x22\x27]?.*?(?P=element)\x2Ewidth.*?(?P=element)\x2Eheight/si"; metadata:service smtp; reference:cve,2015-2414; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065; classtype:attempted-recon; sid:35195; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Microsoft Internet Explorer InPrivate mode image information leak attempt"; flow:to_server,established; file_data; content:".getElementById"; nocase; content:".height"; within:100; nocase; content:".width"; within:50; nocase; pcre:"/\x2EgetElementById\x28[\x22\x27]?(?P<element>\w+)[\x22\x27]?.*?(?P=element)\x2Eheight.*?(?P=element)\x2Ewidth/si"; metadata:service smtp; reference:cve,2015-2414; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065; classtype:attempted-recon; sid:35194; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Microsoft Internet Explorer InPrivate mode image information leak attempt"; flow:to_client,established; file_data; content:".getElementById"; nocase; content:".width"; within:100; nocase; content:".height"; within:50; nocase; pcre:"/\x2EgetElementById\x28[\x22\x27]?(?P<element>\w+)[\x22\x27]?.*?(?P=element)\x2Ewidth.*?(?P=element)\x2Eheight/si"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2015-2414; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065; classtype:attempted-recon; sid:35193; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Microsoft Internet Explorer InPrivate mode image information leak attempt"; flow:to_client,established; file_data; content:".getElementById"; nocase; content:".height"; within:100; nocase; content:".width"; within:50; nocase; pcre:"/\x2EgetElementById\x28[\x22\x27]?(?P<element>\w+)[\x22\x27]?.*?(?P=element)\x2Eheight.*?(?P=element)\x2Ewidth/si"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2015-2414; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065; classtype:attempted-recon; sid:35192; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Remote non-JavaScript file found in script tag src attribute"; flow:to_server,established; file_data; content:"<script"; content:"src="; within:30; isdataat:50,relative; isdataat:!100,relative; content:!"|2E|js"; within:50; metadata:service smtp; reference:cve,2015-1729; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065; classtype:policy-violation; sid:35181; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Remote non-JavaScript file found in script tag src attribute"; flow:to_client,established; file_data; content:"<script"; content:"src="; within:30; isdataat:50,relative; isdataat:!100,relative; content:!"|2E|js"; within:50; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2015-1729; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065; classtype:policy-violation; sid:35180; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Microsoft Internet Explorer IE6 compatibility mode attempt"; flow:to_server,established; file_data; content:"http-equiv="; nocase; content:"X-UA-Compatible"; within:50; nocase; content:"content="; within:50; nocase; content:"IE=6"; within:50; nocase; metadata:service smtp; reference:url,msdn.microsoft.com/en-us/library/ms533876%28v=vs.85%29.aspx; classtype:policy-violation; sid:35148; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Microsoft Internet Explorer IE6 compatibility mode attempt"; flow:to_client,established; file_data; content:"http-equiv="; nocase; content:"X-UA-Compatible"; within:50; nocase; content:"content="; within:50; nocase; content:"IE=6"; within:50; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:url,msdn.microsoft.com/en-us/library/ms533876%28v=vs.85%29.aspx; classtype:policy-violation; sid:35147; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Microsoft cabinet file default sha1 signature detected"; flow:to_server,established; flowbits:isset,file.cab; file_data; content:"|06 09 2A 86 48 86 F7 0D 01 01 05 05 00|"; fast_pattern:only; metadata:service smtp; reference:cve,2015-2466; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081; classtype:misc-attack; sid:35528; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Microsoft cabinet file default sha1 signature detected"; flow:to_client,established; flowbits:isset,file.cab; file_data; content:"|06 09 2A 86 48 86 F7 0D 01 01 05 05 00|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2015-2466; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081; classtype:misc-attack; sid:35527; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8045 (msg:"POLICY-OTHER EMC AutoStart ftagent insecure opcode 20 subcode 2219 access attempt"; flow:to_server,established; content:"|31 00 00 00|"; depth:4; content:"|00 00 00 00 00 00 00 14 00 00 08 AB|"; within:12; distance:4; metadata:policy max-detect-ips drop; reference:bugtraq,74426; reference:cve,2015-0538; classtype:policy-violation; sid:35539; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8045 (msg:"POLICY-OTHER EMC AutoStart ftagent insecure opcode 20 subcode 2060 access attempt"; flow:to_server,established; content:"|31 00 00 00|"; depth:4; content:"|00 00 00 00 00 00 00 14 00 00 08 0C|"; within:12; distance:4; metadata:policy max-detect-ips drop; reference:bugtraq,74426; reference:cve,2015-0538; classtype:policy-violation; sid:35538; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY-OTHER OCSP response with no nextUpdate field"; flow:to_client,established; content:"content-type|3A| application/ocsp-response"; fast_pattern:only; http_header; file_data; content:"|80 00 18 0F|"; isdataat:500,relative; content:!"|A0 11 18 0F|"; within:500; metadata:service http; reference:cve,2015-4748; reference:url,www.oracle.com/technetwork/topics/security/cpujul2015-2367936.html; classtype:policy-violation; sid:35598; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Symantec Endpoint Protection insecure password reset attempt"; flow:to_server,established; content:"/servlet/ConsoleServlet"; nocase; http_uri; content:"ActionType=ResetPassword"; fast_pattern:only; metadata:service http; reference:cve,2015-1486; classtype:policy-violation; sid:35670; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 51000 (msg:"POLICY-OTHER EMC Documentum Content Server remote access attempt"; flow:to_server,established; content:"|0A|QUERY STRING"; fast_pattern:only; reference:cve,2014-2514; reference:cve,2015-4532; reference:url,www.emc.com/enterprise-content-management/index.htm; classtype:policy-violation; sid:35849; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY-OTHER BitTorrent distributed reflected denial-of-service attempt"; flow:stateless; content:"|13|BitTorrent protocol"; fast_pattern:only; detection_filter:track by_dst, count 70, seconds 5; reference:url,usenix.org/conference/woot15/workshop-program/presentation/p2p-file-sharing-hell-exploiting-bittorrent; classtype:attempted-dos; sid:36194; rev:1;)
alert tcp $EXTERNAL_NET 23 -> $HOME_NET any (msg:"POLICY-OTHER Cisco router Security Device Manager default banner"; flow:to_client,established; content:"the one-time use of the username |22|cisco|22| with the |0A|password |22|cisco|22|."; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service telnet; reference:url,www.cisco.com/c/en/us/td/docs/routers/access/iad880/hardware/installation/guide/IAD880HIG/4InitialConfigIAD880.pdf; classtype:policy-violation; sid:36282; rev:1;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"POLICY-OTHER dnstunnel v0.5 outbound traffic detected"; flow:to_server; content:"|01 00|"; depth:2; offset:2; byte_test:1,>,20,12; content:"|00 19 00 01|"; offset:34; detection_filter:track by_src, count 10, seconds 1; metadata:service dns; reference:url,www.hsc.fr/ressources/outils/dns2tcp/index.html.en; classtype:policy-violation; sid:36379; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Remote non-VBScript file found in Visual Basic script tag src attribute"; flow:to_server,established; file_data; content:"<script"; content:"text/vbs"; within:30; content:"src="; within:30; isdataat:100,relative; content:!"|2E|vbs"; within:100; metadata:service smtp; reference:cve,2015-6059; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-108; classtype:policy-violation; sid:36422; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Remote non-VBScript file found in Visual Basic script tag src attribute"; flow:to_client,established; file_data; content:"<script"; content:"text/vbs"; within:30; content:"src="; within:30; isdataat:100,relative; content:!"|2E|vbs"; within:100; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2015-6059; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-108; classtype:policy-violation; sid:36421; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Remote non-VBScript file found in Visual Basic script tag src attribute"; flow:to_server,established; file_data; content:"<script"; content:"language"; within:30; content:"vbscript"; within:30; content:"src="; within:30; isdataat:100,relative; content:!"|2E|vbs"; within:100; metadata:service smtp; reference:cve,2015-6059; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-108; classtype:policy-violation; sid:36420; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Remote non-VBScript file found in Visual Basic script tag src attribute"; flow:to_client,established; file_data; content:"<script"; content:"language"; within:30; content:"vbscript"; within:30; content:"src="; within:30; isdataat:100,relative; content:!"|2E|vbs"; within:100; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2015-6059; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-108; classtype:policy-violation; sid:36419; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1720 (msg:"POLICY-OTHER Polycom Botnet inbound connection attempt"; flow:to_server,established; file_data; content:"|03 00|"; depth:2; content:"|08 02|"; within:2; distance:2; content:"|00|c|00|i|00|s|00|c|00|o"; within:60; content:"ooh323"; distance:0; fast_pattern; reference:url,support.polycom.com/global/documents/support/documentation/H_3_2_3_Botnet_Bulletin_v_1_1.pdf; classtype:trojan-activity; sid:36541; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER Symantec LiveUpdate forcepasswd.do insecure password change attempt"; flow:to_server,established; content:"/lua/forcepasswd.do"; fast_pattern:only; http_uri; content:"newPassword"; nocase; http_client_body; metadata:service http; reference:bugtraq,66399; reference:cve,2014-1644; reference:url,osvdb.org/show/osvdb/105090; classtype:policy-violation; sid:36784; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER self-signed SSL certificate eDellRoot use attempt"; flow:to_client,established; content:"|16 03|"; depth:2; byte_test:1,<,4,0,relative; content:"|6B C5 7B 95 18 93 AA 97 4B 62 4A C0 88 FC 3B B6|"; fast_pattern:only; content:"|09|eDellRoot"; metadata:service ssl; classtype:policy-violation; sid:36887; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL/TLS weak RC4 cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|00 05|"; within:2; metadata:service ssl; reference:bugtraq,73684; reference:cve,2015-2808; reference:url,osvdb.org/show/osvdb/117855; classtype:policy-violation; sid:37026; rev:2;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL/TLS weak RC4 cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|00 04|"; within:2; metadata:service ssl; reference:bugtraq,73684; reference:cve,2015-2808; reference:url,osvdb.org/show/osvdb/117855; classtype:policy-violation; sid:37025; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER ManageEngine EventLog Analyzer runQuery.do insecure SQL query attempt"; flow:to_server,established; content:"/event/runQuery.do"; fast_pattern:only; http_uri; content:"execute=true"; nocase; content:"query="; nocase; metadata:service http; reference:bugtraq,76866; reference:cve,2015-7387; classtype:policy-violation; sid:36915; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 53413 (msg:"POLICY-OTHER Netcore/Netis firmware hard-coded backdoor account access attempt"; flow:to_server; content:"netcore"; depth:7; offset:8; reference:url,nearsecurity.net/love-china-netisbackdoor-exploitation/; classtype:attempted-admin; sid:37545; rev:1;)
# alert tcp any any -> any any (msg:"POLICY-OTHER junk rule to autoenable pop3.stat flowbit"; flow:to_client,established; content:"237<pop3.stat>5yefahr78ah4r7ayrq7yq3tr4ga78"; fast_pattern:only; flowbits:isset,pop3.stat; metadata:policy max-detect-ips alert; classtype:misc-activity; sid:37683; rev:1;)
# alert tcp any any -> any any (msg:"POLICY-OTHER junk rule to autoenable smb.session.negotiate flowbit"; flow:to_client,established; content:"237<smb.session.negotiate>5yefahr78ah4r7ayrq7yq3tr4ga78"; fast_pattern:only; flowbits:isset,smb.session.negotiate; metadata:policy max-detect-ips alert; classtype:misc-activity; sid:37682; rev:1;)
# alert tcp any any -> any any (msg:"POLICY-OTHER junk rule to autoenable vnetd.bpspsserver.connection flowbit"; flow:to_client,established; content:"237<vnetd.bpspsserver.connection>5yefahr78ah4r7ayrq7yq3tr4ga78"; fast_pattern:only; flowbits:isset,vnetd.bpspsserver.connection; metadata:policy max-detect-ips alert; classtype:misc-activity; sid:37681; rev:1;)
# alert tcp any any -> any any (msg:"POLICY-OTHER eicar test string download attempt"; flow:to_client,established; file_data; content:"7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+"; fast_pattern:only; reference:url,www.eicar.org/86-0-Intended-use.html; classtype:misc-activity; sid:37732; rev:1;)
# alert tcp any any -> any any (msg:"POLICY-OTHER junk rule to autoenable imap.cram_md5 flowbit"; flow:to_client,established; content:"237<imap.cram_md5>5yefahr78ah4r7ayrq7yq3tr4ga78"; fast_pattern:only; flowbits:isset,imap.cram_md5; metadata:policy max-detect-ips alert; classtype:misc-activity; sid:37845; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1720 (msg:"POLICY-OTHER Polycom Botnet inbound connection attempt"; flow:to_server,established; file_data; content:"|03 00|"; depth:2; content:"|08 02|"; within:2; distance:2; content:"EE|A8 C6|3"; within:80; content:"ooh323"; distance:6; fast_pattern; metadata:ruleset community; reference:url,support.polycom.com/global/documents/support/documentation/H_3_2_3_Botnet_Bulletin_v_1_2.pdf; classtype:trojan-activity; sid:37815; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1720 (msg:"POLICY-OTHER Polycom Botnet inbound connection attempt"; flow:to_server,established; file_data; content:"|03 00|"; depth:2; content:"|08|"; distance:2; content:"|05|"; distance:4; content:"MERA RTU"; within:100; fast_pattern; metadata:ruleset community; reference:url,support.polycom.com/global/documents/support/documentation/H_3_2_3_Botnet_Bulletin_v_1_2.pdf; classtype:trojan-activity; sid:37814; rev:1;)
# alert tcp any any -> any any (msg:"POLICY-OTHER junk rule to autoenable vnc.server.auth.types flowbit"; flow:to_client,established; content:"237<vnc.server.auth.types>5yefahr78ah4r7ayrq7yq3tr4ga78"; fast_pattern:only; flowbits:isset,vnc.server.auth.types; metadata:policy max-detect-ips alert; classtype:misc-activity; sid:37813; rev:1;)
# alert tcp any any -> any any (msg:"POLICY-OTHER junk rule to autoenable vnc.handshake.client flowbit"; flow:to_client,established; content:"237<vnc.handshake.client>5yefahr78ah4r7ayrq7yq3tr4ga78"; fast_pattern:only; flowbits:isset,vnc.handshake.client; metadata:policy max-detect-ips alert; classtype:misc-activity; sid:37812; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Adobe Flash file containing protoType.valueOf function download detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|09|prototype"; fast_pattern:only; content:"|07|valueOf"; nocase; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38059; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Adobe Flash file containing getDefinitionByName function download detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|13|getDefinitionByName"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38058; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Adobe Flash file containing parseFloat function download detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|0A|parseFloat"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38057; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Adobe Flash file containing domainMemory function download detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|0C|domainMemory"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38056; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Adobe Flash file containing defaultValue function download detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|0C|defaultValue"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38055; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Adobe Flash file containing protoType.valueOf function download detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|09|prototype"; fast_pattern:only; content:"|07|valueOf"; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38054; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Adobe Flash file containing getDefinitionByName function download detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|13|getDefinitionByName"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38053; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Adobe Flash file containing parseFloat function download detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|0A|parseFloat"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38052; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Adobe Flash file containing domainMemory function download detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|0C|domainMemory"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38051; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Adobe Flash file containing defaultValue function download detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|0C|defaultValue"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38050; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER PDF containing U3D object download detected"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/Subtype"; nocase; content:"/U3D"; within:20; fast_pattern; nocase; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38048; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER PDF containing mluc tag object download detected"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"mluc|00 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38047; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER PDF ActiveX CLSID access detected"; flow:to_server, established; file_data; content:"CA8A9780-280D-11CF-A24D-444553540000"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2014-0527; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; classtype:attempted-user; sid:38046; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER PDF ActiveX CLSID access detected"; flow:to_server, established; file_data; content:"AcroPDF.PDF"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2014-0527; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; classtype:attempted-user; sid:38045; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER PDF containing AcroForm key download detected"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/AcroForm"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-1092; classtype:policy-violation; sid:38044; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER PDF containing Action key download detected"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/Action"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38043; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER PDF containing Launch key download detected"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/Launch"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38042; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER PDF containing U3D object download detected"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Subtype"; nocase; content:"/U3D"; within:20; fast_pattern; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38041; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER PDF containing mluc tag object download detected"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"mluc|00 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38040; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER PDF ActiveX CLSID access detected"; flow:to_client, established; file_data; content:"CA8A9780-280D-11CF-A24D-444553540000"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0527; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; classtype:attempted-user; sid:38039; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER PDF ActiveX CLSID access detected"; flow:to_client, established; file_data; content:"AcroPDF.PDF"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0527; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; classtype:attempted-user; sid:38038; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER PDF containing AcroForm key download detected"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/AcroForm"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1092; classtype:policy-violation; sid:38037; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER PDF containing Action key download detected"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Action"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38036; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER PDF containing Launch key download detected"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Launch"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38035; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Adobe Flash file containing allowLoadBytesCodeExecution function download detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|6E|allowLoadBytesCodeExecution"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38034; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Adobe Flash file containing allowLoadBytesCodeExecution function download detected "; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|6E|allowLoadBytesCodeExecution"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38033; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Adobe Flash file containing atomicCompareAndSwapLength function download detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|1A|atomicCompareAndSwapLength"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38032; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Adobe Flash file containing loadBytes function download detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|09|loadBytes"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38031; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Adobe Flash file containing ExternalInterface function download detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|11|ExternalInterface"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:policy-violation; sid:38030; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Adobe Flash file containing atomicCompareAndSwapLength function download detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|1A|atomicCompareAndSwapLength"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38029; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Adobe Flash file containing loadBytes function"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|09|loadBytes"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38028; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Adobe Flash file containing ExternalInterface function download detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|11|ExternalInterface"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:policy-violation; sid:38027; rev:2;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL/TLS weak RC4 cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|C0 16|"; within:2; metadata:service ssl; reference:bugtraq,73684; reference:cve,2015-2808; reference:url,osvdb.org/show/osvdb/117855; classtype:policy-violation; sid:37916; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL/TLS weak RC4 cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|C0 11|"; within:2; metadata:service ssl; reference:bugtraq,73684; reference:cve,2015-2808; reference:url,osvdb.org/show/osvdb/117855; classtype:policy-violation; sid:37915; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL/TLS weak RC4 cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|C0 0C|"; within:2; metadata:service ssl; reference:bugtraq,73684; reference:cve,2015-2808; reference:url,osvdb.org/show/osvdb/117855; classtype:policy-violation; sid:37914; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL/TLS weak RC4 cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|C0 07|"; within:2; metadata:service ssl; reference:bugtraq,73684; reference:cve,2015-2808; reference:url,osvdb.org/show/osvdb/117855; classtype:policy-violation; sid:37913; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL/TLS weak RC4 cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|C0 02|"; within:2; metadata:service ssl; reference:bugtraq,73684; reference:cve,2015-2808; reference:url,osvdb.org/show/osvdb/117855; classtype:policy-violation; sid:37912; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 9855 (msg:"POLICY-OTHER Symantec Workspace Streaming insecure java serialized data upload attempt"; flow:to_server,established; content:"xmlrpc"; nocase; content:"ManagementAgentServer.putFile"; fast_pattern:only; content:"<methodName"; nocase; content:"serializable"; nocase; content:"rO0A"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,67189; reference:cve,2014-1649; classtype:policy-violation; sid:37880; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:"POLICY-OTHER SSLv2 Client Hello attempt"; flow:to_server,established; ssl_state:client_hello; ssl_version:sslv2; content:"|01 00 02|"; depth:3; offset:2; metadata:service ssl; reference:cve,2015-3197; reference:cve,2016-0800; classtype:policy-violation; sid:38060; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER HTTP Request missing user-agent"; flow:to_server,established; content:"GET"; nocase; http_method; content:"User-Agent:"; nocase; http_header; content:"|0D 0A|"; within:3; http_header; metadata:service http; reference:url,ietf.org/rfc/rfc2616.txt; classtype:misc-activity; sid:38130; rev:1;)
# alert udp $HOME_NET any -> any 53 (msg:"POLICY-OTHER Suspicious typo squatting DNS query to .om TLD attempt"; flow:to_server; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|om|00|"; distance:0; nocase; pcre:"/(?:netflix|yahoo|htc|huffingtonpost|nbc|bankofamerica|youtube|reddit|linkedin|facebook|live|google|baidu|gmail|xbox|adidas|hilton|ctrip|dangdang|directv|douban|drugstore|dubizzle|eastmoney|enterprise|etao|fiverr|one|qq|qv|si|sogou|tuniu|usaa|weather|weibo|y8|yatra)c?\x02om\x00/si"; metadata:service dns; reference:url,blogs.splunk.com/2016/04/01/hunting-that-evil-typosquatter/; reference:url,www.endgame.com/blog/what-does-oman-house-cards-and-typosquatting-have-common-om-domain-and-dangers-typosquatting; classtype:policy-violation; sid:38457; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER PDF containing XDP structure download detected"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"<xdp:xdp"; fast_pattern:only; metadata:service smtp; reference:cve,2016-1092; classtype:policy-violation; sid:38823; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER PDF containing XDP structure download detected"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"<xdp:xdp"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2016-1092; classtype:policy-violation; sid:38822; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY-OTHER VMware vCenter Chargeback Manager ImageUploadServlet arbitrary JSP file upload attempt"; flow:to_server,established; content:"POST"; http_method; content:"/cbmui/ImageUploadServlet"; fast_pattern:only; http_uri; metadata:service http; reference:bugtraq,60484; reference:cve,2013-3520; reference:url,osvdb.org/show/osvdb/94188; reference:url,www.vmware.com/security/advisories/VMSA-2013-0008.html; classtype:policy-violation; sid:38964; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Google Chromium ClusterFuzz fuzzer generated code detected"; flow:to_server,established; file_data; content:"g_ele_ref_parent"; nocase; content:"g_ele_ref_parent"; within:300; nocase; content:"g_ele_ref_son"; nocase; content:"g_ele_ref_son"; within:300; nocase; metadata:service smtp; reference:url,www.chromium.org/Home/chromium-security/bugs/using-clusterfuzz; classtype:policy-violation; sid:39502; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Google Chromium ClusterFuzz fuzzer generated code detected"; flow:to_client,established; file_data; content:"g_ele_ref_parent"; nocase; content:"g_ele_ref_parent"; within:300; nocase; content:"g_ele_ref_son"; nocase; content:"g_ele_ref_son"; within:300; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:url,www.chromium.org/Home/chromium-security/bugs/using-clusterfuzz; classtype:policy-violation; sid:39501; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER AutoItv3 Aut2Exe interpreter - compiled script"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|A3 48 4B BE 98 6C 4A A9 99 4C 53 0A 86 D6 48 7D|"; fast_pattern:only; content:"AU3!EA0"; metadata:service smtp; reference:url,autoitscript.com/autoit3/docs/intro/compiler.htm; reference:url,blog.didierstevens.com/2007/10/02/autoit-malware-revisited/; classtype:policy-violation; sid:40029; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER AutoItv3 Aut2Exe interpreter - compiled script"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|A3 48 4B BE 98 6C 4A A9 99 4C 53 0A 86 D6 48 7D|"; fast_pattern:only; content:"AU3!EA0"; metadata:service ftp-data, service http, service imap, service pop3; reference:url,autoitscript.com/autoit3/docs/intro/compiler.htm; reference:url,blog.didierstevens.com/2007/10/02/autoit-malware-revisited/; classtype:policy-violation; sid:40028; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 22 (msg:"POLICY-OTHER SSH weak blowfish cipher suite use attempt"; flow:to_server,established; content:"|00 00 00 0C|blowfish-cbc|00 00 00 0C|blowfish-cbc"; fast_pattern:only; reference:bugtraq,92630; reference:cve,2016-2183; classtype:policy-violation; sid:40190; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 22 (msg:"POLICY-OTHER SSH weak 3DES cipher suite use attempt"; flow:to_server,established; content:"|00 00 00 08|3des-cbc|00 00 00 08|3des-cbc"; fast_pattern:only; reference:bugtraq,92630; reference:cve,2016-2183; classtype:policy-violation; sid:40189; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL weak 3DES cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|C0 1C|"; within:2; metadata:service ssl; reference:bugtraq,92630; reference:cve,2016-2183; classtype:policy-violation; sid:40188; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL weak 3DES cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|00 8B|"; within:2; metadata:service ssl; reference:bugtraq,92630; reference:cve,2016-2183; classtype:policy-violation; sid:40187; rev:1;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY-OTHER SSL weak 3DES cipher suite use attempt"; flow:to_client,established; ssl_state:server_hello; content:"|02|"; depth:1; offset:5; byte_jump:1,37,relative; content:"|00 0A|"; within:2; metadata:service ssl; reference:bugtraq,92630; reference:cve,2016-2183; classtype:policy-violation; sid:40186; rev:1;)
